<div class="highlight"><pre><span class="k">function</span><span class="w"> </span>[theta, J_history] <span class="p">=</span><span class="w"> </span><span class="nf">gradientDescent</span><span class="p">(</span>X, y, theta, alpha, num_iters<span class="p">)</span><span class="w"></span>
<span class="c">%GRADIENTDESCENT Performs gradient descent to learn theta</span>
<span class="c">%   theta = GRADIENTDESENT(X, y, theta, alpha, num_iters) updates theta by </span>
<span class="c">%   taking num_iters gradient steps with learning rate alpha</span>

<span class="c">% Initialize some useful values</span>
<span class="n">m</span> <span class="p">=</span> <span class="nb">length</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="c">% number of training examples</span>
<span class="n">J_history</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="n">num_iters</span><span class="p">,</span> 1<span class="p">);</span>
<span class="k">for</span> <span class="n">iter</span> <span class="p">=</span> 1<span class="p">:</span><span class="n">num_iters</span>
    <span class="c">%theta1 = theta(1) - alpha * X(:,1)&#39; *(X * theta - y) / m;</span>
    <span class="c">%theta2 = theta(2) - alpha * X(:,2)&#39; *(X * theta - y) / m;</span>
    <span class="c">%theta = [theta1; theta2]</span>
    <span class="n">theta</span> <span class="p">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="n">m</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">&#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span> <span class="o">*</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">y</span><span class="p">));</span>
    <span class="c">% Save the cost J in every iteration    </span>
    <span class="n">J_history</span><span class="p">(</span><span class="n">iter</span><span class="p">)</span> <span class="p">=</span> <span class="n">computeCost</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">);</span>
<span class="k">end</span>
<span class="k">end</span>
</pre></div>